{% extends 'base.html' %}
{% load static %}

{% block title %}Transporte #{{ lecom.pk }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/expedicao/detalhe_carga.css' %}">
{% endblock %}

{% block content %}
<div class="sgl-page">

  <!-- HEADER -->
  <header class="sgl-header">
    <div>
      <h3>Transporte #{{ lecom.pk }}</h3>
      <span>LECOM {{ lecom.lecom }} • {{ lecom.destino }}</span>
    </div>

    <form method="post">
      {% csrf_token %}
      <button type="submit" class="btn-primary">
        Liberar Separação
      </button>
    </form>
  </header>

  <!-- KPIs -->
  <section class="sgl-kpis">
    <div class="kpi">
      <span>Peso</span>
      <strong>{{ lecom.peso }} kg</strong>
    </div>

    <div class="kpi">
      <span>Volume</span>
      <strong>{{ lecom.m3 }} m³</strong>
    </div>

    <div class="kpi">
      <span>Cargas</span>
      <strong>{{ cargas|length }}</strong>
    </div>

    <div class="kpi">
      <span>Veículo</span>
      <strong>{{ lecom.veiculo.tipo_veiculo|default:"—" }}</strong>
    </div>
  </section>

  <!-- DADOS DO TRANSPORTE -->
  <section class="sgl-card">
    <h5>Dados do Transporte</h5>

    <div class="sgl-grid">
      <div>
        <label>Destino</label>
        <p>{{ lecom.destino }}</p>
      </div>

      <div>
        <label>Data</label>
        <p>{{ lecom.data|date:"d/m/Y" }}</p>
      </div>

      <div>
        <label>Observação</label>
        <p>{{ lecom.observacao|default:"—" }}</p>
      </div>
    </div>
  </section>

  <!-- CARGAS -->
  <section class="sgl-card">
    <div class="sgl-card-header">
      <h5>Cargas Vinculadas</h5>
      <span>{{ cargas|length }} registro(s)</span>
    </div>

    <div class="sgl-table">
      <div class="sgl-table-head">
        <span>SEQ</span>
        <span>Carga</span>
        <span>Entregas</span>
        <span>MOD</span>
      </div>

      {% for carga in cargas %}
      <div class="sgl-table-row">
        <span>{{ carga.seq }}</span>
        <span>{{ carga.carga }}</span>
        <span>{{ carga.total_entregas }}</span>
        <span>{{ carga.mod }}</span>
      </div>
      {% empty %}
      <div class="sgl-empty">
        Nenhuma carga vinculada
      </div>
      {% endfor %}
    </div>
  </section>

</div>
{% endblock %}
