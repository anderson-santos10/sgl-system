{% extends 'base.html' %}
{% load static %}

{% block title %}Transporte #{{ lecom.pk }}{% endblock %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/expedicao/detalhe_carga.css' %}">

<div class="container mt-4">

  <!-- HEADER DA PÁGINA -->
  <div class="mb-4">
    <h4 class="mb-1 fw-semibold">
      Transporte #{{ lecom.pk }}
    </h4>
    <small class="text-muted">
      Painel operacional de separação e conferência
    </small>
  </div>

  <!-- DASHBOARD -->
  <section class="stats-wrapper">

    <!-- CARD PRINCIPAL -->
    <div class="stats-grid">

      <article class="stats-card">

        <!-- HEADER DO CARD -->
        <div class="stats-header">
          <div>
            <h5 class="stats-title mb-1">Dados do Transporte</h5>
            <small class="text-muted">Identificação e logística</small>
          </div>

          <div class="stats-main">
            #{{ lecom.pk }}
          </div>
        </div>

        <!-- IDENTIFICAÇÃO -->
        <div class="stats-highlight">
          <div class="stats-row">
            <span class="stats-label">LECOM</span>
            <span class="stats-value">{{ lecom.lecom }}</span>
          </div>
        </div>

        <!-- DADOS LOGÍSTICOS -->
        <div class="stats-list">

          <div class="stats-row">
            <span class="stats-label">Destino</span>
            <span class="stats-value">{{ lecom.destino }}</span>
          </div>

          <div class="stats-row">
            <span class="stats-label">Data do Transporte</span>
            <span class="stats-value">
              {{ lecom.data|date:"d/m/Y" }}
            </span>
          </div>

          <div class="stats-row">
            <span class="stats-label">Veículo</span>
            <span class="stats-value">
              {{ lecom.veiculo.tipo_veiculo|default:"Não informado" }}
            </span>
          </div>

        </div>

        <hr class="my-3">

        <!-- DADOS OPERACIONAIS -->
        <div class="stats-list">

          <div class="stats-row">
            <span class="stats-label">Peso Total</span>
            <span class="stats-value">
              {{ lecom.peso }} kg
            </span>
          </div>

          <div class="stats-row">
            <span class="stats-label">Volume Total</span>
            <span class="stats-value">
              {{ lecom.m3 }} m³
            </span>
          </div>

          <div class="stats-row">
            <span class="stats-label">Quantidade de Cargas</span>
            <span class="stats-value">
              {{ cargas|length }}
            </span>
          </div>

          <div class="stats-row">
            <span class="stats-label">Observação</span>
            <span class="stats-value">
              {{ lecom.observacao|default:"—" }}
            </span>
          </div>

        </div>

      </article>

    </div>

    <!-- RESUMO DAS CARGAS -->
    <section class="stats-summary mt-5">

      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="section-title mb-0">
          Cargas Vinculadas
        </h5>
        <small class="text-muted">
          {{ cargas|length }} carga(s)
        </small>
      </div>

      <div class="row g-3">
        {% for carga in cargas %}
          <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">

            <article class="carga-card h-100">

              <p class="mb-1">
                <strong class="text-primary">
                  SEQ {{ carga.seq }}
                </strong>
              </p>

              <p class="mb-1">
                <strong>Carga:</strong> {{ carga.carga }}
              </p>

              <p class="mb-1">
                <strong>Entregas:</strong> {{ carga.total_entregas }}
              </p>

              <p class="mb-0">
                <strong>MOD:</strong> {{ carga.mod }}
              </p>

            </article>

          </div>
        {% empty %}
          <div class="col-12 text-muted">
            Nenhuma carga vinculada a este transporte.
          </div>
        {% endfor %}
      </div>

    </section>

    <!-- AÇÕES -->
    <section class="stats-actions mt-5">
      <form method="post" class="d-flex justify-content-end">
        {% csrf_token %}
        <button type="submit" class="btn-save">
          ✔ Liberar Separação
        </button>
      </form>
    </section>

  </section>

</div>

{% endblock %}
