{% load static %}
<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{% block title %}Minha Página{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{% static 'img/sgl-favicon.png' %}">
    <link rel="shortcut icon" href="{% static 'img/sgl-favicon.png' %}">


    <!-- Bootstrap e ícones -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">

    <!-- CSS base -->
    
    <link rel="stylesheet" href="{% static 'css/sgl/variables.css' %}">
    <link rel="stylesheet" href="{% static 'css/sgl/sgl-tokens.css' %}">
    <link rel="stylesheet" href="{% static 'css/sgl/sgl-base.css' %}">
    <link rel="stylesheet" href="{% static 'css/sgl/layouts.css' %}">
    <link rel="stylesheet" href="{% static 'css/sgl/components.css' %}">
    <link rel="stylesheet" href="{% static 'css/sgl/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">

    {% block extra_css %}{% endblock %}

</head>
<body>

<div class="app-layout">

    <!-- OFFCANVAS FILTRO -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasFiltro">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">
                <i class="bi bi-funnel"></i> Filtro
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>

        <div class="offcanvas-body">
            <form method="get" action="{% block filter_action %}{% endblock %}">
                {% block filter_fields %}{% endblock %}
                <button type="submit" class="btn btn-primary w-100 mt-3">
                    Aplicar Filtros
                </button>
            </form>
        </div>
    </div>

    <!-- SIDEBAR -->
    <aside class="sidebar">

        <!-- Logo -->
        <div class="sidebar-logo text-center py-4">
            <h4 class="fw-bold text-white">SGL</h4>
            <p class="small m-0 text-white-50">Sistema Gestão Logística</p>
            <hr class="text-white-50 mt-3 mb-2">
        </div>

        <!-- Dashboard -->
        <a href="{% url 'dashboard_home' %}" class="sidebar-link">
            <i class="bi bi-graph-up me-2"></i> Dashboard
        </a>

        {% if user.is_authenticated %}
        <div class="accordion accordion-flush" id="menuAccordion">

            <!-- RECEBIMENTO -->
            <div class="accordion-item bg-transparent border-0">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed bg-transparent text-white"
                            type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseRecebimento">
                        <i class="bi bi-box-seam me-2"></i> Recebimento
                    </button>
                </h2>
                <div id="collapseRecebimento" class="accordion-collapse collapse"
                     data-bs-parent="#menuAccordion">
                    <div class="accordion-body">
                        <a href="{% url 'notas_list' %}" class="sidebar-sub">
                            Controle de Notas
                        </a>
                    </div>
                </div>
            </div>

            <!-- EXPEDIÇÃO -->
            <div class="accordion-item bg-transparent border-0">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed bg-transparent text-white"
                            type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseExpedicao">
                        <i class="bi bi-box-arrow-right me-2"></i> Expedição
                    </button>
                </h2>
                <div id="collapseExpedicao" class="accordion-collapse collapse"
                     data-bs-parent="#menuAccordion">
                    <div class="accordion-body">
                        <a href="{% url 'expedicao:cenario_expedicao' %}" class="sidebar-sub">
                            Cenário Expedição
                        </a>
                    </div>
                    <div class="accordion-body">
                        <a href="{% url 'expedicao:cenario_separacao' %}" class="sidebar-sub">
                            Cenário Separação
                        </a>
                    </div>
                </div>
            </div>

            <!-- TRANSPORTE -->
            <div class="accordion-item bg-transparent border-0">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed bg-transparent text-white"
                            type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseTransporte">
                        <i class="bi bi-truck me-2"></i> Transporte
                    </button>
                </h2>
                <div id="collapseTransporte" class="accordion-collapse collapse"
                     data-bs-parent="#menuAccordion">
                    <div class="accordion-body">
                        <a href="{% url 'transport:cenario_transporte' %}" class="sidebar-sub">
                            Cenário Transporte
                        </a>
                    </div>
                </div>
            </div>

        </div>
        {% endif %}

        <!-- PERFIL -->
        <div class="profile mt-auto text-center mb-3">
            {% if user.is_authenticated %}
                <a href="#" class="text-white dropdown-toggle" data-bs-toggle="dropdown">
                    <img src="{{ user.profile.image.url|default:'/static/img/an.jpg' }}"
                         class="rounded-circle profile-img">
                </a>
                <ul class="dropdown-menu dropdown-menu-dark">
                    <li class="dropdown-item-text">Olá, {{ user.username }}</li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <form method="post" action="{% url 'logout' %}">
                            {% csrf_token %}
                            <button type="submit" class="dropdown-item">Sair</button>
                        </form>
                    </li>
                </ul>
            {% endif %}
        </div>

    </aside>

    <!-- CONTEÚDO -->
    <main class="content">
        {% block content %}{% endblock %}
    </main>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'js/base/offcanvas_filtro.js' %}"></script>
</body>
</html>
